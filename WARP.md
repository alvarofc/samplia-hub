# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

## Project Overview

This is an Astro-based web application configured for deployment on Cloudflare Workers. The project uses:
- **Framework**: Astro 5.x
- **Runtime**: Cloudflare Workers (via @astrojs/cloudflare adapter)
- **Package Manager**: pnpm (based on README references)
- **TypeScript**: Strict mode configuration

## Key Commands

All commands use npm/pnpm/bun scripts. Run from the repository root:

- **Build**: `bun build` - Builds production site to `./dist/`
- **Preview**: `bun preview` - Builds and previews using Wrangler local dev server
- **Deploy**: `bun deploy` - Builds and deploys to Cloudflare Workers
- **Generate Types**: `bun cf-typegen` - Generates Cloudflare Worker type definitions

**Important**: Do NOT run `bun dev` unless explicitly instructed by the user.

## Architecture

### Cloudflare Integration

This project is tightly integrated with Cloudflare Workers:

- **Adapter**: Uses `@astrojs/cloudflare` with platform proxy enabled for local development
- **Image Service**: Configured to use Cloudflare's image optimization
- **Type Definitions**: Auto-generated worker configuration types in `worker-configuration.d.ts`
- **Environment Types**: Custom `Env` interface extends `Cloudflare.Env` with an `ASSETS` fetcher

### Type System

The project has a specific type setup for Cloudflare Workers integration:

- `src/env.d.ts` - Defines `App.Locals` extending Cloudflare runtime types
- `worker-configuration.d.ts` - Generated by Wrangler, contains full Cloudflare Workers runtime types
- TypeScript configured with strict mode and includes both Node.js and Cloudflare Worker types

### Project Structure

Standard Astro layout:
- `src/pages/` - Route pages (file-based routing)
- `src/layouts/` - Reusable page layouts
- `src/components/` - Astro components
- `src/assets/` - Static assets processed by Astro
- `public/` - Static files served directly

## Development Guidelines

### Cloudflare Context

When working with server-side code:
- Access Cloudflare bindings via `Astro.locals` (which extends `Runtime<Env>`)
- The `Env` interface defines available bindings (currently only `ASSETS`)
- Use the platform proxy feature for local testing of Cloudflare features

### Deployment Flow

The project supports Cloudflare Workers deployment:
1. Astro builds the static site
2. Wrangler packages and deploys to Cloudflare Workers
3. Cloudflare image service handles image optimization

### File Associations

The project configures VS Code to treat `wrangler.json` as JSONC (JSON with comments).
